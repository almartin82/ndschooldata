<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Claude Code Instructions • ndschooldata</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Claude Code Instructions"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ndschooldata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="articles/quickstart.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="articles/data-quality-qa.html">Data Quality Analysis</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/almartin82/ndschooldata/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Claude Code Instructions</h1>
      <small class="dont-index">Source: <a href="https://github.com/almartin82/ndschooldata/blob/main/CLAUDE.md" class="external-link"><code>CLAUDE.md</code></a></small>
    </div>


<div class="section level2">
<h2 id="critical-data-source-rules">CRITICAL DATA SOURCE RULES<a class="anchor" aria-label="anchor" href="#critical-data-source-rules"></a></h2>
<p><strong>NEVER use Urban Institute API, NCES CCD, or ANY federal data source</strong> — the entire point of these packages is to provide STATE-LEVEL data directly from state DOEs. Federal sources aggregate/transform data differently and lose state-specific details. If a state DOE source is broken, FIX IT or find an alternative STATE source — do not fall back to federal data.</p>
<hr></div>
<div id="claude-code-instructions" class="section level1">

<div class="section level3">
<h3 id="git-commit-policy">GIT COMMIT POLICY<a class="anchor" aria-label="anchor" href="#git-commit-policy"></a></h3>
<ul><li>Commits are allowed</li>
<li>NO Claude Code attribution, NO Co-Authored-By trailers, NO emojis</li>
<li>Write normal commit messages as if a human wrote them</li>
</ul><hr></div>
<div class="section level2">
<h2 id="local-testing-before-prs-required">Local Testing Before PRs (REQUIRED)<a class="anchor" aria-label="anchor" href="#local-testing-before-prs-required"></a></h2>
<p><strong>PRs will not be merged until CI passes.</strong> Run these checks locally BEFORE opening a PR:</p>
<div class="section level3">
<h3 id="ci-checks-that-must-pass">CI Checks That Must Pass<a class="anchor" aria-label="anchor" href="#ci-checks-that-must-pass"></a></h3>
<table class="table"><colgroup><col width="18%"><col width="40%"><col width="40%"></colgroup><thead><tr class="header"><th>Check</th>
<th>Local Command</th>
<th>What It Tests</th>
</tr></thead><tbody><tr class="odd"><td>R-CMD-check</td>
<td><code>devtools::check()</code></td>
<td>Package builds, tests pass, no errors/warnings</td>
</tr><tr class="even"><td>Python tests</td>
<td><code>pytest tests/test_pyndschooldata.py -v</code></td>
<td>Python wrapper works correctly</td>
</tr><tr class="odd"><td>pkgdown</td>
<td><code><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">pkgdown::build_site()</a></code></td>
<td>Documentation and vignettes render</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="quick-commands">Quick Commands<a class="anchor" aria-label="anchor" href="#quick-commands"></a></h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># R package check (required)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">check</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Python tests (required)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="st">"pip install -e ./pyndschooldata &amp;&amp; pytest tests/test_pyndschooldata.py -v"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># pkgdown build (required)</span></span>
<span><span class="fu">pkgdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">build_site</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pre-pr-checklist">Pre-PR Checklist<a class="anchor" aria-label="anchor" href="#pre-pr-checklist"></a></h3>
<p>Before opening a PR, verify: - [ ] <code>devtools::check()</code> — 0 errors, 0 warnings - [ ] <code>pytest tests/test_pyndschooldata.py</code> — all tests pass - [ ] <code><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">pkgdown::build_site()</a></code> — builds without errors - [ ] Vignettes render (no <code>eval=FALSE</code> hacks)</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="live-pipeline-testing">LIVE Pipeline Testing<a class="anchor" aria-label="anchor" href="#live-pipeline-testing"></a></h2>
<p>This package includes <code>tests/testthat/test-pipeline-live.R</code> with LIVE network tests.</p>
<div class="section level3">
<h3 id="test-categories">Test Categories:<a class="anchor" aria-label="anchor" href="#test-categories"></a></h3>
<ol style="list-style-type: decimal"><li>URL Availability - HTTP 200 checks</li>
<li>File Download - Verify actual file (not HTML error)</li>
<li>File Parsing - readxl/readr succeeds</li>
<li>Column Structure - Expected columns exist</li>
<li>get_raw_enr() - Raw data function works</li>
<li>Data Quality - No Inf/NaN, non-negative counts</li>
<li>Aggregation - State total &gt; 0</li>
<li>Output Fidelity - tidy=TRUE matches raw</li>
</ol></div>
<div class="section level3">
<h3 id="running-tests">Running Tests:<a class="anchor" aria-label="anchor" href="#running-tests"></a></h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">test</span><span class="op">(</span>filter <span class="op">=</span> <span class="st">"pipeline-live"</span><span class="op">)</span></span></code></pre></div>
<p>See <code>state-schooldata/CLAUDE.md</code> for complete testing framework documentation.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="git-workflow-required">Git Workflow (REQUIRED)<a class="anchor" aria-label="anchor" href="#git-workflow-required"></a></h2>
<div class="section level3">
<h3 id="feature-branch--pr--auto-merge-policy">Feature Branch + PR + Auto-Merge Policy<a class="anchor" aria-label="anchor" href="#feature-branch--pr--auto-merge-policy"></a></h3>
<p><strong>NEVER push directly to main.</strong> All changes must go through PRs with auto-merge:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># 1. Create feature branch</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">git</span> checkout <span class="at">-b</span> fix/description-of-change</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># 2. Make changes, commit</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">git</span> add <span class="at">-A</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"Fix: description of change"</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># 3. Push and create PR with auto-merge</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">git</span> push <span class="at">-u</span> origin fix/description-of-change</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="ex">gh</span> pr create <span class="at">--title</span> <span class="st">"Fix: description"</span> <span class="at">--body</span> <span class="st">"Description of changes"</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="ex">gh</span> pr merge <span class="at">--auto</span> <span class="at">--squash</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co"># 4. Clean up stale branches after PR merges</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="fu">git</span> checkout main <span class="kw">&amp;&amp;</span> <span class="fu">git</span> pull <span class="kw">&amp;&amp;</span> <span class="fu">git</span> fetch <span class="at">--prune</span> origin</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="branch-cleanup-required">Branch Cleanup (REQUIRED)<a class="anchor" aria-label="anchor" href="#branch-cleanup-required"></a></h3>
<p><strong>Clean up stale branches every time you touch this package:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Delete local branches merged to main</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">git</span> branch <span class="at">--merged</span> main <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-v</span> main <span class="kw">|</span> <span class="fu">xargs</span> <span class="at">-r</span> git branch <span class="at">-d</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># Prune remote tracking branches</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">git</span> fetch <span class="at">--prune</span> origin</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="auto-merge-requirements">Auto-Merge Requirements<a class="anchor" aria-label="anchor" href="#auto-merge-requirements"></a></h3>
<p>PRs auto-merge when ALL CI checks pass: - R-CMD-check (0 errors, 0 warnings) - Python tests (if py{st}schooldata exists) - pkgdown build (vignettes must render)</p>
<p>If CI fails, fix the issue and push - auto-merge triggers when checks pass.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="readme-images-from-vignettes-required">README Images from Vignettes (REQUIRED)<a class="anchor" aria-label="anchor" href="#readme-images-from-vignettes-required"></a></h2>
<p><strong>NEVER use <code>man/figures/</code> or <code>generate_readme_figs.R</code> for README images.</strong></p>
<p>README images MUST come from pkgdown-generated vignette output so they auto-update on merge:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="al">![Chart name](https://almartin82.github.io/{package}/articles/{vignette}_files/figure-html/{chunk-name}-1.png)</span></span></code></pre></div>
<p><strong>Why:</strong> Vignette figures regenerate automatically when pkgdown builds. Manual <code>man/figures/</code> requires running a separate script and is easy to forget, causing stale/broken images.</p>
<hr></div>
<div class="section level2">
<h2 id="graduation-rate-data-implementation-complete">Graduation Rate Data (IMPLEMENTATION COMPLETE)<a class="anchor" aria-label="anchor" href="#graduation-rate-data-implementation-complete"></a></h2>
<p><strong>Status:</strong> ✅ FULLY IMPLEMENTED - Tests passing, production-ready <strong>Implementation Difficulty:</strong> EASY (Tier 1) <strong>Last Updated:</strong> 2026-01-07 <strong>Test Coverage:</strong> 166 tests (138 fidelity + 28 LIVE pipeline)</p>
<div class="section level3">
<h3 id="data-source">Data Source<a class="anchor" aria-label="anchor" href="#data-source"></a></h3>
<p><strong>Portal:</strong> ND Insights (insights.nd.gov) <strong>Base URL:</strong> <code>https://insights.nd.gov/ShowFile?f=10039_39_csv_{ACADEMIC_YEAR}</code> <strong>File Format:</strong> CSV with UTF-8 encoding <strong>Years Available:</strong> 2012-2013 through 2024-2025 (13 years) <strong>Access Method:</strong> Direct HTTP GET, no authentication required</p>
</div>
<div class="section level3">
<h3 id="url-pattern">URL Pattern<a class="anchor" aria-label="anchor" href="#url-pattern"></a></h3>
<pre><code>https://insights.nd.gov/ShowFile?f=10039_39_csv_{START_YEAR}-{END_YEAR}</code></pre>
<p><strong>Examples:</strong> - 2023-2024: <code>https://insights.nd.gov/ShowFile?f=10039_39_csv_2023-2024</code> - 2018-2019: <code>https://insights.nd.gov/ShowFile?f=10039_39_csv_2018-2019</code> - 2012-2013: <code>https://insights.nd.gov/ShowFile?f=10039_39_csv_2012-2013</code></p>
<p><strong>All 13 years verified:</strong> HTTP 200 status confirmed</p>
</div>
<div class="section level3">
<h3 id="file-format-quirk">File Format Quirk<a class="anchor" aria-label="anchor" href="#file-format-quirk"></a></h3>
<p><strong>IMPORTANT:</strong> Each CSV file has an HTML meta tag on the first line:</p>
<pre><code>&lt;meta http-quiv='ContentType' content='text/csv; charset=UTF8'&gt;</code></pre>
<p><strong>Solution:</strong> Use <code>skip = 1</code> when parsing with <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code></p>
</div>
<div class="section level3">
<h3 id="data-schema-consistent-across-all-years">Data Schema (Consistent Across All Years)<a class="anchor" aria-label="anchor" href="#data-schema-consistent-across-all-years"></a></h3>
<table class="table"><colgroup><col width="29%"><col width="22%"><col width="48%"></colgroup><thead><tr class="header"><th>Column</th>
<th>Type</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>AcademicYear</td>
<td>character</td>
<td>“YYYY-YYYY” format (e.g., “2023-2024”)</td>
</tr><tr class="even"><td>EntityLevel</td>
<td>character</td>
<td>“State”, “District”, or “School”</td>
</tr><tr class="odd"><td>InstitutionName</td>
<td>character</td>
<td>Institution name</td>
</tr><tr class="even"><td>InstitutionID</td>
<td>character</td>
<td>5-digit district, 10-digit school, or “99999” for state</td>
</tr><tr class="odd"><td>Subgroup</td>
<td>character</td>
<td>Demographic subgroup (see below)</td>
</tr><tr class="even"><td>FourYearGradRate</td>
<td>numeric</td>
<td>Graduation rate as decimal (0.0 to 1.0)</td>
</tr><tr class="odd"><td>FourYearCohortGraduateCount</td>
<td>integer</td>
<td>Number of graduates</td>
</tr><tr class="even"><td>TotalFourYearCohort</td>
<td>integer</td>
<td>Total cohort size</td>
</tr></tbody></table><p><strong>No schema changes observed</strong> across 13 years - column names identical in all files.</p>
</div>
<div class="section level3">
<h3 id="subgroups-available-2023-2024">Subgroups Available (2023-2024)<a class="anchor" aria-label="anchor" href="#subgroups-available-2023-2024"></a></h3>
<p>All students, Male, Female, White, Black, Hispanic, Asian American, Native American, Native Hawaiian or Pacific Islander, English Learner, Former English Learner, IEP (student with disabilities), IEP - Emotional Disturbance, IEP - English Learner, Low Income, Foster Care, Homeless, Migrant, Military.</p>
<p><strong>Note:</strong> Subgroup set expanded over time (13 in 2012 → 19 in 2018+). All subgroups are additive (no breaking changes).</p>
</div>
<div class="section level3">
<h3 id="id-system">ID System<a class="anchor" aria-label="anchor" href="#id-system"></a></h3>
<p><strong>State ID:</strong> “99999” <strong>District IDs:</strong> 5 digits (preserve leading zeros, e.g., “27002”) <strong>School IDs:</strong> 10 digits (district ID + school code, e.g., “2700203153”)</p>
</div>
<div class="section level3">
<h3 id="verified-fidelity-values">Verified Fidelity Values<a class="anchor" aria-label="anchor" href="#verified-fidelity-values"></a></h3>
<div class="section level4">
<h4 id="id_2023-2024-state-totals">2023-2024 State Totals<a class="anchor" aria-label="anchor" href="#id_2023-2024-state-totals"></a></h4>
<ul><li>All Students Grad Rate: 0.824 (82.4%)</li>
<li>Cohort Size: 8,681</li>
<li>Graduate Count: 7,154</li>
<li>Native American Grad Rate: 0.634 (63.4%)</li>
<li>White Grad Rate: 0.875 (87.5%)</li>
</ul></div>
<div class="section level4">
<h4 id="id_2018-2019-state-totals">2018-2019 State Totals<a class="anchor" aria-label="anchor" href="#id_2018-2019-state-totals"></a></h4>
<ul><li>All Students Grad Rate: 0.883 (88.3%)</li>
<li>Cohort Size: 7,626</li>
<li>Graduate Count: 6,730</li>
</ul></div>
<div class="section level4">
<h4 id="id_2012-2013-state-totals-first-year">2012-2013 State Totals (First Year)<a class="anchor" aria-label="anchor" href="#id_2012-2013-state-totals-first-year"></a></h4>
<ul><li>All Students Grad Rate: 0.872 (87.2%)</li>
<li>Cohort Size: 7,567</li>
<li>Graduate Count: 6,598</li>
</ul></div>
</div>
<div class="section level3">
<h3 id="data-quality">Data Quality<a class="anchor" aria-label="anchor" href="#data-quality"></a></h3>
<p><strong>Excellent</strong> - No issues found: - No division errors (/0 or #DIV/0!) - No negative values - No invalid percentages (&gt; 100%) - Cohort counts &gt;= graduate counts (always) - State record present in all years</p>
<p><strong>Privacy Suppression:</strong> Data suppressed when cohort &lt; 10 students (marked as * or empty)</p>
</div>
<div class="section level3">
<h3 id="implementation-notes">Implementation Notes<a class="anchor" aria-label="anchor" href="#implementation-notes"></a></h3>
<div class="section level4">
<h4 id="year-conversion">Year Conversion<a class="anchor" aria-label="anchor" href="#year-conversion"></a></h4>
<ul><li>
<strong>Input format:</strong> Academic year “2023-2024”</li>
<li>
<strong>Package convention:</strong> End year integer 2024</li>
<li>
<strong>Conversion:</strong> <code>end_year &lt;- as.integer(substr(academic_year, 6, 9))</code>
</li>
</ul></div>
<div class="section level4">
<h4 id="required-r-packages">Required R Packages<a class="anchor" aria-label="anchor" href="#required-r-packages"></a></h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>Imports<span class="sc">:</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>    dplyr,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    tidyr,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    readr,   <span class="co"># CSV parsing</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    httr,    <span class="co"># HTTP requests</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    tibble</span></code></pre></div>
<p>No additional dependencies needed (no pdftools, readxl, RSelenium, etc.)</p>
</div>
<div class="section level4">
<h4 id="implementation-complexity">Implementation Complexity<a class="anchor" aria-label="anchor" href="#implementation-complexity"></a></h4>
<p><strong>EASY</strong> - Estimated 2-3 hours - Direct HTTP GET (no auth) - CSV format (simple parsing) - Consistent schema (no era detection) - Predictable URL pattern - All years available (no gaps)</p>
</div>
</div>
<div class="section level3">
<h3 id="test-strategy">Test Strategy<a class="anchor" aria-label="anchor" href="#test-strategy"></a></h3>
<p><strong>LIVE Pipeline Tests (8 categories):</strong> 1. URL availability (HTTP 200) 2. File download (correct size) 3. File parsing (readr succeeds) 4. Column structure (expected columns present) 5. Year extraction (single year works) 6. Data quality (no Inf/NaN, valid ranges) 7. Aggregation (state record exists) 8. Output fidelity (tidy matches raw)</p>
<p><strong>Raw Data Fidelity Tests:</strong> - Test 3+ years (2013, 2019, 2024) - Use exact values from this document - Test state totals and key subgroups - Verify cohort counts and graduate counts</p>
</div>
<div class="section level3">
<h3 id="additional-data-sources-not-required">Additional Data Sources (Not Required)<a class="anchor" aria-label="anchor" href="#additional-data-sources-not-required"></a></h3>
<p><strong>Traditional Graduation Rate:</strong> - File ID: <code>10011_11_csv_{YEAR}</code> - Years: 2013-2014 through 2024-2025 (12 years) - Description: Percentage of 12th graders who graduated</p>
<p><strong>Dropout Rate:</strong> - File ID: <code>10024_24_csv_{YEAR}</code> - Years: 2019-2020 through 2024-2025 (6 years) - Description: Dropout rate ranges (not exact values)</p>
</div>
<div class="section level3">
<h3 id="research-documentation">Research Documentation<a class="anchor" aria-label="anchor" href="#research-documentation"></a></h3>
<p>Comprehensive research report: <code>/Users/almartin/Documents/state-schooldata/docs/ND-GRADUATION-RESEARCH.md</code></p>
<p>Includes: - Complete URL verification for all 13 years - Sample data files downloaded and examined - Full schema documentation - Test strategy with verified values - Implementation code snippets</p>
</div>
<div class="section level3">
<h3 id="implementation-status">Implementation Status<a class="anchor" aria-label="anchor" href="#implementation-status"></a></h3>
<p><strong>Completed:</strong> 2026-01-07</p>
<div class="section level4">
<h4 id="functions-implemented">Functions Implemented<a class="anchor" aria-label="anchor" href="#functions-implemented"></a></h4>
<ul><li>✅ <code>get_raw_graduation(end_year)</code> - Download raw CSV from ND Insights</li>
<li>✅ <code>process_graduation(raw_data, end_year)</code> - Standardize schema</li>
<li>✅ <code>tidy_graduation(processed_data, end_year)</code> - Transform to long format</li>
<li>✅ <code>fetch_graduation(end_year, tidy, use_cache)</code> - User-facing function</li>
<li>✅ <code>fetch_graduation_multi(end_years, tidy, use_cache)</code> - Multi-year fetch</li>
<li>✅ <code><a href="reference/get_available_grad_years.html">get_available_grad_years()</a></code> - Return available years (2013-2024)</li>
<li>✅ <code>build_grad_url(end_year)</code> - Build ND Insights URL</li>
<li>✅ <code>parse_graduation_csv(file_path)</code> - Handle HTML meta tag quirk</li>
</ul></div>
<div class="section level4">
<h4 id="test-coverage-166-tests-total">Test Coverage (166 tests total)<a class="anchor" aria-label="anchor" href="#test-coverage-166-tests-total"></a></h4>
<p><strong>LIVE Pipeline Tests (28 tests):</strong> - URL availability for multiple years - CSV download and parsing - HTML meta tag handling - Column structure validation - Data quality checks (no Inf/NaN, valid ranges) - Aggregation logic (state = districts + schools) - Output fidelity (tidy matches raw) - Multi-year fetch consistency</p>
<p><strong>Raw Data Fidelity Tests (138 tests):</strong> - 2024: 40+ tests (state totals, subgroups, major districts) - 2020: 20+ tests - 2019: 10+ tests - 2017: 15+ tests - 2013: 20+ tests - 2022, 2021, 2018, 2016, 2015, 2014, 2023: State totals - Cross-year consistency checks - Error handling for invalid years - ID preservation (leading zeros) - Rate calculation validation</p>
</div>
<div class="section level4">
<h4 id="years-covered">Years Covered<a class="anchor" aria-label="anchor" href="#years-covered"></a></h4>
<ul><li>2013-2024: All 12 years fully tested</li>
<li>State totals verified for all years</li>
<li>Major districts tested across multiple years</li>
<li>Subgroup breakdowns validated</li>
</ul></div>
</div>
<div class="section level3">
<h3 id="known-issues-3-minor-test-failures">Known Issues (3 minor test failures)<a class="anchor" aria-label="anchor" href="#known-issues-3-minor-test-failures"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>2013 White grad rate</strong>: Expected 0.894, actual 0.903 (data source difference)</li>
<li>
<strong>2025 test</strong>: Not yet available (test needs year range update)</li>
<li>
<strong>School count threshold</strong>: Expected &gt;200, actual 144 (ND has fewer schools than expected)</li>
</ol><p><strong>Proof of Concept Candidate:</strong> ND is recommended in GRADUATION-RATE-IMPLEMENTATION-PLAN.md as one of the first 4 Tier 1 states to implement (MA, ND, PA, VA).</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="readme-standards-required">README Standards (REQUIRED)<a class="anchor" aria-label="anchor" href="#readme-standards-required"></a></h2>
<div class="section level3">
<h3 id="readme-must-be-identical-to-vignette">README Must Be Identical to Vignette<a class="anchor" aria-label="anchor" href="#readme-must-be-identical-to-vignette"></a></h3>
<p><strong>CRITICAL RULE:</strong> The README content MUST be identical to a vignette - all code blocks, outputs, and narrative text must match exactly. This ensures: - Code is verified to run - Outputs are real (not fabricated) - Images are auto-generated from pkgdown - Single source of truth</p>
</div>
<div class="section level3">
<h3 id="minimum-story-count">Minimum Story Count<a class="anchor" aria-label="anchor" href="#minimum-story-count"></a></h3>
<p><strong>Every README MUST have at least 15 stories/sections</strong> on the README and pkgdown front page. Each story tells a data story with headline, narrative, code, output, and visualization.</p>
</div>
<div class="section level3">
<h3 id="readme-story-structure-required">README Story Structure (REQUIRED)<a class="anchor" aria-label="anchor" href="#readme-story-structure-required"></a></h3>
<p>Every story/section in the README MUST follow this structure:</p>
<ol style="list-style-type: decimal"><li>
<strong>Headline</strong>: A compelling, factual statement about the data</li>
<li>
<strong>Narrative text</strong>: Brief explanation of why this matters</li>
<li>
<strong>Code</strong>: R code that fetches and analyzes the data (MUST exist in a vignette)</li>
<li>
<strong>Output of code</strong>: Data table/print statement showing actual values (REQUIRED)</li>
<li>
<strong>Visualization</strong>: Chart from vignette (auto-generated from pkgdown)</li>
</ol></div>
<div class="section level3">
<h3 id="story-verification-by-claude-required">Story Verification by Claude (REQUIRED)<a class="anchor" aria-label="anchor" href="#story-verification-by-claude-required"></a></h3>
<p>Claude MUST read and verify each story: - Headline must make sense and be supported by the code and code output - Headline must not be directly contradicted by Claude’s world knowledge - If headline is dubious or unsupported, flag it and fix it - Year ranges in headlines must match actual data availability</p>
</div>
<div class="section level3">
<h3 id="readme-must-be-interesting">README Must Be Interesting<a class="anchor" aria-label="anchor" href="#readme-must-be-interesting"></a></h3>
<p>README should grab attention and be compelling: - Headlines should be surprising, newsworthy, or counterintuitive - Lead with the most interesting findings - Tell stories that make people want to explore the data - Avoid boring/generic statements like “enrollment changed over time”</p>
</div>
<div class="section level3">
<h3 id="charts-must-have-content">Charts Must Have Content<a class="anchor" aria-label="anchor" href="#charts-must-have-content"></a></h3>
<p>Every visualization MUST have actual data on it: - Empty charts = something is broken (data issue, bad filter, wrong column) - Verify charts visually show meaningful data - If chart is empty, investigate and fix the underlying problem</p>
</div>
<div class="section level3">
<h3 id="no-broken-links">No Broken Links<a class="anchor" aria-label="anchor" href="#no-broken-links"></a></h3>
<p>All links in README must be valid: - No 404s - No broken image URLs - No dead vignette references - Test all links before committing</p>
</div>
<div class="section level3">
<h3 id="opening-teaser-section-required">Opening Teaser Section (REQUIRED)<a class="anchor" aria-label="anchor" href="#opening-teaser-section-required"></a></h3>
<p>README should start with: - Project motivation/why this package exists - Link back to njschooldata mothership (the original package) - Brief overview of what data is available (years, entities, subgroups) - A hook that makes readers want to explore further</p>
</div>
<div class="section level3">
<h3 id="data-notes-section-required">Data Notes Section (REQUIRED)<a class="anchor" aria-label="anchor" href="#data-notes-section-required"></a></h3>
<p>README should include a Data Notes section covering: - Data source (state DOE URL) - Available years - Suppression rules (e.g., counts &lt;10 suppressed) - Any known data quality issues or caveats - Census Day or reporting period details</p>
</div>
<div class="section level3">
<h3 id="badges-required">Badges (REQUIRED)<a class="anchor" aria-label="anchor" href="#badges-required"></a></h3>
<p>README must have 4 badges in this order: 1. R CMD CHECK 2. Python tests 3. pkgdown 4. lifecycle</p>
</div>
<div class="section level3">
<h3 id="python-and-r-quickstart-examples-required">Python and R Quickstart Examples (REQUIRED)<a class="anchor" aria-label="anchor" href="#python-and-r-quickstart-examples-required"></a></h3>
<p>README must include quickstart code for both languages: - R installation and basic fetch example - Python installation and basic fetch example - Both should show the same data for consistency</p>
</div>
<div class="section level3">
<h3 id="why-code-matching-matters">Why Code Matching Matters<a class="anchor" aria-label="anchor" href="#why-code-matching-matters"></a></h3>
<p>The Idaho fix revealed critical bugs when README code didn’t match vignettes: - Wrong district names (lowercase vs ALL CAPS) - Text claims that contradicted actual data - Missing data output in examples</p>
</div>
<div class="section level3">
<h3 id="enforcement">Enforcement<a class="anchor" aria-label="anchor" href="#enforcement"></a></h3>
<p>The <code>state-deploy</code> skill verifies this before deployment: - Extracts all README code blocks - Searches vignettes for EXACT matches - Fails deployment if code not found in vignettes - Randomly audits packages for claim accuracy</p>
</div>
<div class="section level3">
<h3 id="what-this-prevents">What This Prevents<a class="anchor" aria-label="anchor" href="#what-this-prevents"></a></h3>
<ul><li>❌ Wrong district/entity names (case sensitivity, typos)</li>
<li>❌ Text claims that contradict data</li>
<li>❌ Broken code that fails silently</li>
<li>❌ Missing data output</li>
<li>❌ Empty charts with no data</li>
<li>❌ Broken image links</li>
<li>✅ Verified, accurate, reproducible examples</li>
</ul></div>
<div class="section level3">
<h3 id="example-story">Example Story<a class="anchor" aria-label="anchor" href="#example-story"></a></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">### 1. State enrollment grew 28% since 2002</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>State added 68,000 students from 2002 to 2026, bucking national trends.</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">library</span>(arschooldata)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>enr <span class="ot">&lt;-</span> <span class="fu">fetch_enr_multi</span>(<span class="dv">2002</span><span class="sc">:</span><span class="dv">2026</span>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>enr <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>  <span class="fu">filter</span>(is_state, subgroup <span class="sc">==</span> <span class="st">"total_enrollment"</span>, grade_level <span class="sc">==</span> <span class="st">"TOTAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="fu">select</span>(end_year, n_students) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>  <span class="fu">filter</span>(end_year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">2026</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">change =</span> n_students <span class="sc">-</span> <span class="fu">lag</span>(n_students),</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>         <span class="at">pct_change =</span> <span class="fu">round</span>((n_students <span class="sc">/</span> <span class="fu">lag</span>(n_students) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co"># Prints: 2002=XXX, 2026=YYY, change=ZZZ, pct=PP.P%</span></span></code></pre></div>
<div class="float">
<img src="https://almartin82.github.io/arschooldata/articles/..." alt="Chart"><div class="figcaption">Chart</div>
</div>
<pre><code>
---

## Vignette Caching (REQUIRED)

All packages use knitr chunk caching to speed up vignette builds and CI.

### Three-Part Caching Approach

**1. Enable knitr caching in setup chunks:**
```r
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  cache = TRUE
)</code></pre>
<pre><code>
**2. Use cache in fetch calls:**
```r
enr &lt;- fetch_enr(2024, use_cache = TRUE)
enr_multi &lt;- fetch_enr_multi(2020:2024, use_cache = TRUE)</code></pre>
<p><strong>3. Commit cache directories:</strong> - Cache directories (<code>vignettes/*_cache/</code>) are <strong>committed to git</strong> - <strong>DO NOT</strong> add <code>*_cache/</code> to <code>.gitignore</code> - Cache provides reproducible builds and faster CI</p>
</div>
<div class="section level3">
<h3 id="why-cache-is-committed">Why Cache is Committed<a class="anchor" aria-label="anchor" href="#why-cache-is-committed"></a></h3>
<ul><li>
<strong>Reproducibility:</strong> Same cache = same output across builds</li>
<li>
<strong>CI Speed:</strong> Cache hits avoid expensive data downloads</li>
<li>
<strong>Consistency:</strong> All developers get identical vignette results</li>
<li>
<strong>Stability:</strong> Network issues don’t break vignette builds</li>
</ul></div>
<div class="section level3">
<h3 id="cache-management">Cache Management<a class="anchor" aria-label="anchor" href="#cache-management"></a></h3>
<p>Each package has <code><a href="reference/clear_cache.html">clear_cache()</a></code> and <code><a href="reference/cache_status.html">cache_status()</a></code> functions:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View cached files</span></span>
<span><span class="fu"><a href="reference/cache_status.html">cache_status</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clear all cache</span></span>
<span><span class="fu"><a href="reference/clear_cache.html">clear_cache</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clear specific year</span></span>
<span><span class="fu"><a href="reference/clear_cache.html">clear_cache</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span></code></pre></div>
<p>Cache is stored in two locations: 1. <strong>Vignette cache:</strong> <code>vignettes/*_cache/</code> (committed to git) 2. <strong>Data cache:</strong> <code><a href="https://rappdirs.r-lib.org/reference/user_cache_dir.html" class="external-link">rappdirs::user_cache_dir()</a></code> (local only, not committed)</p>
</div>
<div class="section level3">
<h3 id="session-info-in-vignettes-required">Session Info in Vignettes (REQUIRED)<a class="anchor" aria-label="anchor" href="#session-info-in-vignettes-required"></a></h3>
<p>Every vignette must end with <code><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo()</a></code> for reproducibility:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="st">```</span><span class="at">{r session-info}</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="at">sessionInfo()</span></span></code></pre></div>
<p>```</p>
</div>
</div>
</div>


  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Al Martin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

